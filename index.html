<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Calendar</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }

        .main-wrapper {
            max-width: 1200px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .calendar-title {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 20px 30px;
            text-align: center;
        }

        .calendar-title h1 {
            margin: 0;
            color: #667eea;
            font-size: 28px;
            font-weight: 700;
        }

        .calendar-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .calendar-view {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 20px;
        }

        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .holiday-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 20px;
        }

        .date-calculator {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 20px;
            width: 100%;
        }

        @media (max-width: 900px) {
            .calendar-section {
                grid-template-columns: 1fr;
            }

            .calculator-content {
                grid-template-columns: 1fr;
            }

            .calendar-title h1 {
                font-size: 24px;
            }
        }

        @media (max-width: 480px) {
            .calendar-view,
            .holiday-panel,
            .date-calculator {
                padding: 20px;
            }

            .days {
                gap: 5px;
            }

            .day {
                font-size: 14px;
            }
        }

        .date-calculator h3 {
            color: #667eea;
            margin: 0 0 15px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .calculator-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            align-items: start;
        }

        .calculator-inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .date-input-group {
            margin-bottom: 0;
        }

        .date-input-group label {
            display: block;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .date-input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .date-input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .calculate-btn {
            width: 100%;
            background: #667eea;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .calculate-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .calculate-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .result {
            padding: 20px;
            background: #f8f9ff;
            border-radius: 8px;
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result.show {
            display: block;
        }

        .result-item {
            padding: 8px 0;
            color: #333;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-item strong {
            color: #667eea;
            font-size: 14px;
        }

        .result-item span {
            color: #333;
            font-weight: 600;
        }

        .selector-group {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            align-items: center;
        }

        .selector-group select {
            flex: 1;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            background: white;
            transition: border 0.3s;
        }

        .selector-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .selector-group button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.3s;
            white-space: nowrap;
        }

        .selector-group button:hover {
            background: #5568d3;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .nav-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        }

        .nav-button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .nav-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            margin-bottom: 6px;
        }

        .weekday {
            text-align: center;
            font-weight: bold;
            color: #667eea;
            padding: 6px;
            font-size: 12px;
        }

        .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
        }

        .day {
            aspect-ratio: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .day:hover {
            background: #f0f0f0;
            transform: scale(1.05);
        }

        .day.empty {
            cursor: default;
        }

        .day.empty:hover {
            background: transparent;
            transform: none;
        }

        .day.today {
            background: #667eea;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .day.today:hover {
            background: #5568d3;
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }

        .day.other-month {
            color: #ccc;
        }

        .day.holiday {
            background: #fff3cd;
            position: relative;
        }

        .day.holiday::after {
            content: '‚óè';
            position: absolute;
            bottom: 2px;
            right: 4px;
            font-size: 8px;
            color: #ff6b6b;
        }

        .day.today.holiday {
            background: #667eea;
            color: white;
        }

        .day.today.holiday::after {
            color: #ffeb3b;
        }

        .holiday-legend {
            padding: 0;
            background: transparent;
            border-radius: 8px;
            font-size: 14px;
        }

        .holiday-legend h4 {
            margin: 0 0 12px 0;
            color: #667eea;
            font-size: 16px;
            font-weight: 600;
        }

        .holiday-panel h3 {
            color: #667eea;
            margin: 0 0 12px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .calendar-view h3 {
            color: #667eea;
            margin: 0 0 15px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .holiday-item {
            padding: 8px;
            margin-bottom: 8px;
            color: #555;
            background: #f8f9ff;
            border-radius: 6px;
            border-left: 3px solid #667eea;
            transition: all 0.2s ease;
            cursor: default;
            font-size: 13px;
        }

        .holiday-item:hover {
            background: #eef1ff;
            transform: translateX(2px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .holiday-item:last-child {
            margin-bottom: 0;
        }

        .no-holidays {
            padding: 20px;
            text-align: center;
            color: #999;
            font-style: italic;
        }

        .holiday-name {
            font-weight: 600;
            color: #333;
        }

        .holiday-type {
            font-size: 12px;
            color: #888;
            margin-left: 8px;
        }

        .filter-group {
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-size: 14px;
            color: #555;
        }

        .filter-group input[type="checkbox"] {
            cursor: pointer;
        }

        .day.has-note {
            border: 2px solid #ff9800;
        }

        .day.has-note::before {
            content: 'üìù';
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 10px;
        }

        .notes-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 20px;
        }

        .notes-panel h3 {
            color: #667eea;
            margin: 0 0 15px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .note-input-group {
            margin-bottom: 12px;
        }

        .note-input-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 80px;
            transition: border 0.3s;
        }

        .note-input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .note-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .add-note-btn {
            width: 100%;
            padding: 10px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
            background: #667eea;
            color: white;
        }

        .add-note-btn:hover {
            background: #5568d3;
        }

        .notes-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .note-item {
            padding: 12px;
            background: #f8f9ff;
            border-radius: 8px;
            border-left: 3px solid #667eea;
            position: relative;
            transition: all 0.2s ease;
        }

        .note-item:hover {
            background: #eef1ff;
            transform: translateX(2px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .note-text {
            color: #333;
            font-size: 14px;
            line-height: 1.5;
            word-wrap: break-word;
            margin-bottom: 8px;
        }

        .note-timestamp {
            font-size: 11px;
            color: #888;
            margin-bottom: 8px;
        }

        .note-delete-btn {
            padding: 4px 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
            background: #ff6b6b;
            color: white;
        }

        .note-delete-btn:hover {
            background: #ff5252;
        }

        .selected-date-display {
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9ff;
            border-radius: 8px;
            color: #667eea;
            font-weight: 600;
            text-align: center;
            font-size: 15px;
        }

        .no-date-selected {
            padding: 20px;
            text-align: center;
            color: #999;
            font-style: italic;
        }

        .no-notes-message {
            padding: 20px;
            text-align: center;
            color: #999;
            font-style: italic;
            font-size: 14px;
        }

        .day.selected {
            outline: 3px solid #ff9800;
            outline-offset: -3px;
        }
    </style>
</head>
<body>
    <div class="main-wrapper">
        <div class="calendar-title">
            <h1>Calendar & Date Calculator</h1>
        </div>

        <div class="calendar-section">
            <div class="calendar-view">
                <h3>Calendar</h3>
                <div class="calendar-header">
                    <button class="nav-button" id="prevMonth">&lt;</button>
                    <button class="nav-button" id="nextMonth">&gt;</button>
                </div>
                <div class="selector-group">
                    <select id="monthSelect"></select>
                    <select id="yearSelect"></select>
                    <button id="todayBtn">Today</button>
                </div>
                <div class="weekdays">
                    <div class="weekday">Sun</div>
                    <div class="weekday">Mon</div>
                    <div class="weekday">Tue</div>
                    <div class="weekday">Wed</div>
                    <div class="weekday">Thu</div>
                    <div class="weekday">Fri</div>
                    <div class="weekday">Sat</div>
                </div>
                <div class="days" id="calendarDays"></div>
            </div>

            <div class="right-panel">
                <div class="holiday-panel">
                    <h3>Holidays & Festivals</h3>
                    <div class="filter-group">
                        <label>
                            <input type="checkbox" id="showUSHolidays" checked>
                            US Holidays
                        </label>
                        <label>
                            <input type="checkbox" id="showIndianHolidays" checked>
                            Indian Holidays
                        </label>
                    </div>
                    <div class="holiday-legend" id="holidayLegend">
                        <h4>This Month</h4>
                        <div id="holidayList"></div>
                    </div>
                </div>

                <div class="notes-panel">
                    <h3>Notes</h3>
                    <div id="noteContent">
                        <div class="no-date-selected">Click on a date to add or view notes</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="date-calculator">
            <h3>Date Difference Calculator</h3>
            <div class="calculator-content">
                <div class="calculator-inputs">
                    <div class="date-input-group">
                        <label for="startDate">Start Date</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="date-input-group">
                        <label for="endDate">End Date</label>
                        <input type="date" id="endDate">
                    </div>
                    <button class="calculate-btn" id="calculateBtn">Calculate Difference</button>
                </div>
                <div class="result" id="result">
                    <div class="result-item"><strong>Exact Duration:</strong> <span id="exactDuration">0</span></div>
                    <div class="result-item"><strong>Total Days:</strong> <span id="totalDays">0</span></div>
                    <div class="result-item"><strong>Business Days:</strong> <span id="businessDays">0</span></div>
                    <div class="result-item"><strong>Weeks:</strong> <span id="weeks">0</span></div>
                    <div class="result-item"><strong>Total Months:</strong> <span id="months">0</span></div>
                    <div class="result-item"><strong>Total Years:</strong> <span id="years">0</span></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentDate = new Date();
        let selectedDate = null;
        let notes = JSON.parse(localStorage.getItem('calendarNotes') || '{}');

        const monthNames = [
            "January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"
        ];

        // US Federal Holidays
        const usHolidays = {
            getHolidays(year) {
                const holidays = [];

                // Fixed date holidays
                holidays.push({ month: 0, day: 1, name: "New Year's Day", type: "US" });
                holidays.push({ month: 6, day: 4, name: "Independence Day", type: "US" });
                holidays.push({ month: 10, day: 11, name: "Veterans Day", type: "US" });
                holidays.push({ month: 11, day: 25, name: "Christmas Day", type: "US" });

                // MLK Day - 3rd Monday of January
                holidays.push({ month: 0, day: this.getNthWeekdayOfMonth(year, 0, 1, 3), name: "Martin Luther King Jr. Day", type: "US" });

                // Presidents Day - 3rd Monday of February
                holidays.push({ month: 1, day: this.getNthWeekdayOfMonth(year, 1, 1, 3), name: "Presidents' Day", type: "US" });

                // Memorial Day - Last Monday of May
                holidays.push({ month: 4, day: this.getLastWeekdayOfMonth(year, 4, 1), name: "Memorial Day", type: "US" });

                // Labor Day - 1st Monday of September
                holidays.push({ month: 8, day: this.getNthWeekdayOfMonth(year, 8, 1, 1), name: "Labor Day", type: "US" });

                // Columbus Day - 2nd Monday of October
                holidays.push({ month: 9, day: this.getNthWeekdayOfMonth(year, 9, 1, 2), name: "Columbus Day", type: "US" });

                // Thanksgiving - 4th Thursday of November
                holidays.push({ month: 10, day: this.getNthWeekdayOfMonth(year, 10, 4, 4), name: "Thanksgiving Day", type: "US" });

                return holidays;
            },

            getNthWeekdayOfMonth(year, month, weekday, n) {
                const firstDay = new Date(year, month, 1);
                const firstWeekday = firstDay.getDay();
                let day = 1 + (weekday - firstWeekday + 7) % 7;
                day += (n - 1) * 7;
                return day;
            },

            getLastWeekdayOfMonth(year, month, weekday) {
                const lastDay = new Date(year, month + 1, 0);
                const lastWeekday = lastDay.getDay();
                const daysFromWeekday = (lastWeekday - weekday + 7) % 7;
                return lastDay.getDate() - daysFromWeekday;
            }
        };

        // Indian Holidays (major festivals - some dates are approximate as they follow lunar calendar)
        const indianHolidays = {
            getHolidays(year) {
                const holidays = [];

                // Fixed date holidays
                holidays.push({ month: 0, day: 26, name: "Republic Day", type: "Indian" });
                holidays.push({ month: 7, day: 15, name: "Independence Day", type: "Indian" });
                holidays.push({ month: 9, day: 2, name: "Gandhi Jayanti", type: "Indian" });

                // Approximate dates for festivals (these vary by lunar calendar)
                // 2026 approximate dates
                if (year === 2026) {
                    holidays.push({ month: 2, day: 14, name: "Holi", type: "Indian" });
                    holidays.push({ month: 3, day: 2, name: "Ram Navami", type: "Indian" });
                    holidays.push({ month: 9, day: 17, name: "Dussehra", type: "Indian" });
                    holidays.push({ month: 10, day: 5, name: "Diwali", type: "Indian" });
                    holidays.push({ month: 3, day: 21, name: "Mahavir Jayanti", type: "Indian" });
                    holidays.push({ month: 4, day: 23, name: "Buddha Purnima", type: "Indian" });
                    holidays.push({ month: 7, day: 26, name: "Janmashtami", type: "Indian" });
                }

                // 2025 approximate dates
                if (year === 2025) {
                    holidays.push({ month: 2, day: 14, name: "Holi", type: "Indian" });
                    holidays.push({ month: 3, day: 6, name: "Ram Navami", type: "Indian" });
                    holidays.push({ month: 9, day: 2, name: "Dussehra", type: "Indian" });
                    holidays.push({ month: 9, day: 21, name: "Diwali", type: "Indian" });
                    holidays.push({ month: 3, day: 10, name: "Mahavir Jayanti", type: "Indian" });
                    holidays.push({ month: 4, day: 12, name: "Buddha Purnima", type: "Indian" });
                    holidays.push({ month: 7, day: 16, name: "Janmashtami", type: "Indian" });
                }

                // 2024 dates
                if (year === 2024) {
                    holidays.push({ month: 2, day: 25, name: "Holi", type: "Indian" });
                    holidays.push({ month: 3, day: 17, name: "Ram Navami", type: "Indian" });
                    holidays.push({ month: 9, day: 12, name: "Dussehra", type: "Indian" });
                    holidays.push({ month: 10, day: 1, name: "Diwali", type: "Indian" });
                    holidays.push({ month: 3, day: 21, name: "Mahavir Jayanti", type: "Indian" });
                    holidays.push({ month: 4, day: 23, name: "Buddha Purnima", type: "Indian" });
                    holidays.push({ month: 7, day: 26, name: "Janmashtami", type: "Indian" });
                }

                return holidays;
            }
        };

        function getHolidaysForMonth(year, month) {
            const showUS = document.getElementById('showUSHolidays').checked;
            const showIndian = document.getElementById('showIndianHolidays').checked;

            let allHolidays = [];

            if (showUS) {
                allHolidays = allHolidays.concat(usHolidays.getHolidays(year));
            }

            if (showIndian) {
                allHolidays = allHolidays.concat(indianHolidays.getHolidays(year));
            }

            return allHolidays.filter(h => h.month === month);
        }

        // Initialize month and year selectors
        function initializeSelectors() {
            const monthSelect = document.getElementById('monthSelect');
            const yearSelect = document.getElementById('yearSelect');

            // Populate months
            monthNames.forEach((month, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = month;
                monthSelect.appendChild(option);
            });

            // Populate years (from 1900 to 2100)
            for (let year = 1900; year <= 2100; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }

            // Set current month and year
            updateSelectors();
        }

        function updateSelectors() {
            document.getElementById('monthSelect').value = currentDate.getMonth();
            document.getElementById('yearSelect').value = currentDate.getFullYear();
        }

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            // Update selectors
            updateSelectors();

            // Get holidays for this month
            const holidays = getHolidaysForMonth(year, month);
            const holidayDays = holidays.map(h => h.day);

            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();

            // Get today's date for highlighting
            const today = new Date();
            const isCurrentMonth = today.getFullYear() === year && today.getMonth() === month;
            const todayDate = today.getDate();

            // Clear calendar
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';

            // Add previous month's days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = document.createElement('div');
                day.className = 'day other-month';
                day.textContent = daysInPrevMonth - i;
                calendarDays.appendChild(day);
            }

            // Add current month's days
            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement('div');
                day.className = 'day';
                day.textContent = i;

                const dateKey = `${year}-${month}-${i}`;

                if (isCurrentMonth && i === todayDate) {
                    day.classList.add('today');
                }

                // Mark holidays
                if (holidayDays.includes(i)) {
                    day.classList.add('holiday');
                    const holiday = holidays.find(h => h.day === i);
                    day.title = holiday.name;
                }

                // Mark days with notes
                if (notes[dateKey] && notes[dateKey].length > 0) {
                    day.classList.add('has-note');
                }

                // Mark selected date
                if (selectedDate && selectedDate.year === year && selectedDate.month === month && selectedDate.day === i) {
                    day.classList.add('selected');
                }

                // Add click event for date selection
                day.addEventListener('click', () => selectDate(year, month, i));

                calendarDays.appendChild(day);
            }

            // Add next month's days to fill the grid
            const totalCells = calendarDays.children.length;
            const remainingCells = totalCells % 7 === 0 ? 0 : 7 - (totalCells % 7);

            for (let i = 1; i <= remainingCells; i++) {
                const day = document.createElement('div');
                day.className = 'day other-month';
                day.textContent = i;
                calendarDays.appendChild(day);
            }

            // Update holiday legend
            const holidayList = document.getElementById('holidayList');

            if (holidays.length > 0) {
                holidayList.innerHTML = '';

                holidays.sort((a, b) => a.day - b.day).forEach(holiday => {
                    const item = document.createElement('div');
                    item.className = 'holiday-item';
                    item.innerHTML = `<div><span class="holiday-name">${holiday.name}</span><span class="holiday-type">(${holiday.type})</span></div><div style="font-size: 12px; color: #888; margin-top: 4px;">${monthNames[month]} ${holiday.day}</div>`;
                    holidayList.appendChild(item);
                });
            } else {
                holidayList.innerHTML = '<div class="no-holidays">No holidays this month</div>';
            }
        }

        // Navigation event listeners
        document.getElementById('prevMonth').addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });

        document.getElementById('nextMonth').addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        // Month selector event
        document.getElementById('monthSelect').addEventListener('change', (e) => {
            currentDate.setMonth(parseInt(e.target.value));
            renderCalendar();
        });

        // Year selector event
        document.getElementById('yearSelect').addEventListener('change', (e) => {
            currentDate.setFullYear(parseInt(e.target.value));
            renderCalendar();
        });

        // Today button event
        document.getElementById('todayBtn').addEventListener('click', () => {
            currentDate = new Date();
            renderCalendar();
        });

        // Holiday filter events
        document.getElementById('showUSHolidays').addEventListener('change', renderCalendar);
        document.getElementById('showIndianHolidays').addEventListener('change', renderCalendar);

        // Date difference calculator
        function calculateBusinessDays(startDate, endDate) {
            let count = 0;
            const current = new Date(startDate);

            while (current < endDate) {
                const dayOfWeek = current.getDay();
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    count++;
                }
                current.setDate(current.getDate() + 1);
            }

            return count;
        }

        function calculateExactDuration(startDate, endDate) {
            let years = endDate.getFullYear() - startDate.getFullYear();
            let months = endDate.getMonth() - startDate.getMonth();
            let days = endDate.getDate() - startDate.getDate();

            // Adjust if days are negative
            if (days < 0) {
                months--;
                // Get the number of days in the previous month
                const prevMonth = new Date(endDate.getFullYear(), endDate.getMonth(), 0);
                days += prevMonth.getDate();
            }

            // Adjust if months are negative
            if (months < 0) {
                years--;
                months += 12;
            }

            return { years, months, days };
        }

        function calculateDateDifference() {
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);

            if (!document.getElementById('startDate').value || !document.getElementById('endDate').value) {
                alert('Please select both start and end dates');
                return;
            }

            if (startDate > endDate) {
                alert('Start date must be before end date');
                return;
            }

            // Calculate exact duration in years, months, and days
            const duration = calculateExactDuration(startDate, endDate);
            let exactDurationText = '';
            if (duration.years > 0) {
                exactDurationText += duration.years + (duration.years === 1 ? ' year' : ' years');
            }
            if (duration.months > 0) {
                if (exactDurationText) exactDurationText += ', ';
                exactDurationText += duration.months + (duration.months === 1 ? ' month' : ' months');
            }
            if (duration.days > 0 || exactDurationText === '') {
                if (exactDurationText) exactDurationText += ', ';
                exactDurationText += duration.days + (duration.days === 1 ? ' day' : ' days');
            }

            // Calculate total days (difference between dates)
            const timeDiff = endDate.getTime() - startDate.getTime();
            const totalDays = Math.floor(timeDiff / (1000 * 60 * 60 * 24));

            // Calculate business days
            const businessDays = calculateBusinessDays(startDate, endDate);

            // Calculate weeks
            const weeks = Math.floor(totalDays / 7);

            // Calculate total months (more accurate, as decimal)
            let totalMonths = (endDate.getFullYear() - startDate.getFullYear()) * 12;
            totalMonths += endDate.getMonth() - startDate.getMonth();

            // Add fractional part based on days
            const daysInStartMonth = new Date(startDate.getFullYear(), startDate.getMonth() + 1, 0).getDate();
            const dayFraction = (endDate.getDate() - startDate.getDate()) / daysInStartMonth;
            totalMonths = (totalMonths + dayFraction).toFixed(2);

            // Calculate total years (as decimal)
            const totalYears = (totalDays / 365.25).toFixed(2);

            // Display results
            document.getElementById('exactDuration').textContent = exactDurationText;
            document.getElementById('totalDays').textContent = totalDays;
            document.getElementById('businessDays').textContent = businessDays;
            document.getElementById('weeks').textContent = weeks + ' weeks, ' + (totalDays % 7) + ' days';
            document.getElementById('months').textContent = totalMonths;
            document.getElementById('years').textContent = totalYears;
            document.getElementById('result').classList.add('show');
        }

        document.getElementById('calculateBtn').addEventListener('click', calculateDateDifference);

        // Notes functionality
        function selectDate(year, month, day) {
            selectedDate = { year, month, day };
            renderCalendar();
            displayNotesForDate();
        }

        function getDateKey(year, month, day) {
            return `${year}-${month}-${day}`;
        }

        function displayNotesForDate() {
            if (!selectedDate) {
                document.getElementById('noteContent').innerHTML = '<div class="no-date-selected">Click on a date to add or view notes</div>';
                return;
            }

            const { year, month, day } = selectedDate;
            const dateKey = getDateKey(year, month, day);
            const dateNotes = notes[dateKey] || [];

            const formattedDate = `${monthNames[month]} ${day}, ${year}`;

            let notesListHTML = '';
            if (dateNotes.length > 0) {
                notesListHTML = '<div class="notes-list">';
                dateNotes.forEach((note, index) => {
                    notesListHTML += `
                        <div class="note-item">
                            <div class="note-timestamp">${note.timestamp}</div>
                            <div class="note-text">${note.text}</div>
                            <button class="note-delete-btn" onclick="deleteNote(${index})">Delete</button>
                        </div>
                    `;
                });
                notesListHTML += '</div>';
            } else {
                notesListHTML = '<div class="no-notes-message">No notes for this date</div>';
            }

            document.getElementById('noteContent').innerHTML = `
                <div class="selected-date-display">${formattedDate}</div>
                <div class="note-input-group">
                    <textarea id="noteTextarea" placeholder="Add a new note..."></textarea>
                </div>
                <div class="note-actions">
                    <button class="add-note-btn" onclick="addNote()">Add Note</button>
                </div>
                ${notesListHTML}
            `;
        }

        function addNote() {
            if (!selectedDate) return;

            const { year, month, day } = selectedDate;
            const dateKey = getDateKey(year, month, day);
            const noteText = document.getElementById('noteTextarea').value.trim();

            if (noteText) {
                if (!notes[dateKey]) {
                    notes[dateKey] = [];
                }

                const timestamp = new Date().toLocaleString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric',
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                });

                notes[dateKey].push({
                    text: noteText,
                    timestamp: timestamp
                });

                localStorage.setItem('calendarNotes', JSON.stringify(notes));
                renderCalendar();
                displayNotesForDate();
            } else {
                alert('Please enter some text before adding a note.');
            }
        }

        function deleteNote(index) {
            if (!selectedDate) return;

            const { year, month, day } = selectedDate;
            const dateKey = getDateKey(year, month, day);

            if (notes[dateKey] && notes[dateKey][index]) {
                if (confirm('Are you sure you want to delete this note?')) {
                    notes[dateKey].splice(index, 1);

                    if (notes[dateKey].length === 0) {
                        delete notes[dateKey];
                    }

                    localStorage.setItem('calendarNotes', JSON.stringify(notes));
                    renderCalendar();
                    displayNotesForDate();
                }
            }
        }

        // Set default dates for calculator
        const today = new Date();
        document.getElementById('startDate').valueAsDate = today;
        document.getElementById('endDate').valueAsDate = today;

        // Initial render
        initializeSelectors();
        renderCalendar();
    </script>
</body>
</html>
